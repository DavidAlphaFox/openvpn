<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: G Pages: 1 -->
<svg width="504pt" height="559pt"
 viewBox="0.00 0.00 504.00 559.36" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 555.3576)">
<title>G</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-555.3576 500,-555.3576 500,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_cons</title>
<polygon fill="#66cd00" stroke="#458b00" stroke-width=".8" points="8,-311.3576 8,-427.3576 146,-427.3576 146,-311.3576 8,-311.3576"/>
<text text-anchor="middle" x="77" y="-410.7576" font-family="Times,serif" font-size="14.00" fill="#000000">Consumer</text>
<text text-anchor="middle" x="77" y="-393.9576" font-family="Times,serif" font-size="14.00" fill="#000000">e.g. PongOS</text>
<text text-anchor="middle" x="77" y="-377.1576" font-family="Times,serif" font-size="14.00" fill="#000000">or mirage&#45;firewall</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_two</title>
<path fill="#d3d3d3" stroke="#c0c0c0" stroke-width="1.5" d="M184,-206.0313C184,-206.0313 476,-206.0313 476,-206.0313 482,-206.0313 488,-212.0313 488,-218.0313 488,-218.0313 488,-531.3576 488,-531.3576 488,-537.3576 482,-543.3576 476,-543.3576 476,-543.3576 184,-543.3576 184,-543.3576 178,-543.3576 172,-537.3576 172,-531.3576 172,-531.3576 172,-218.0313 172,-218.0313 172,-212.0313 178,-206.0313 184,-206.0313"/>
<text text-anchor="middle" x="237.7332" y="-526.7576" font-family="Times,serif" font-size="14.00" fill="#000000">VPN unikernel</text>
<text text-anchor="middle" x="237.7332" y="-509.9576" font-family="Times,serif" font-size="14.00" fill="#000000">Multi&#45;stack example</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_provider</title>
<path fill="#d3d3d3" stroke="#c0c0c0" stroke-width="1.5" d="M126,-90.4C126,-90.4 270,-90.4 270,-90.4 276,-90.4 282,-96.4 282,-102.4 282,-102.4 282,-186.0313 282,-186.0313 282,-192.0313 276,-198.0313 270,-198.0313 270,-198.0313 126,-198.0313 126,-198.0313 120,-198.0313 114,-192.0313 114,-186.0313 114,-186.0313 114,-102.4 114,-102.4 114,-96.4 120,-90.4 126,-90.4"/>
<text text-anchor="middle" x="161.4611" y="-181.4313" font-family="Times,serif" font-size="14.00" fill="#000000">VPN provider</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_inet</title>
<polygon fill="none" stroke="#d3d3d3" stroke-width="1.5" stroke-dasharray="5,2" points="290,-8 290,-160.6156 478,-160.6156 478,-8 290,-8"/>
<text text-anchor="middle" x="332.0144" y="-16.2" font-family="Times,serif" font-size="14.00" fill="#000000">The internet</text>
</g>
<!-- cons_firewall -->
<g id="node1" class="node">
<title>cons_firewall</title>
<polygon fill="#7fff00" stroke="#7fff00" points="137.7548,-360.7595 28.2452,-360.7595 28.2452,-364.7595 16.2452,-364.7595 16.2452,-319.5557 137.7548,-319.5557 137.7548,-360.7595"/>
<polyline fill="none" stroke="#7fff00" points="16.2452,-360.7595 28.2452,-360.7595 "/>
<text text-anchor="middle" x="77" y="-344.3576" font-family="Times,serif" font-size="14.00" fill="#000000">Consumer IP stack</text>
<text text-anchor="middle" x="77" y="-327.5576" font-family="Times,serif" font-size="14.00" fill="#000000">10.38.2.2</text>
</g>
<!-- int_stack -->
<g id="node3" class="node">
<title>int_stack</title>
<ellipse fill="#6495ed" stroke="#6495ed" cx="245" cy="-340.1576" rx="60.708" ry="41.109"/>
<ellipse fill="none" stroke="#6495ed" cx="245" cy="-340.1576" rx="64.7147" ry="45.091"/>
<text text-anchor="middle" x="245" y="-352.7576" font-family="Times,serif" font-size="14.00" fill="#000000">Int. IP stack</text>
<text text-anchor="middle" x="245" y="-335.9576" font-family="Times,serif" font-size="14.00" fill="#000000">+ OpenVPN</text>
<text text-anchor="middle" x="245" y="-319.1576" font-family="Times,serif" font-size="14.00" fill="#000000">10.38.2.1</text>
</g>
<!-- cons_firewall&#45;&gt;int_stack -->
<g id="edge7" class="edge">
<title>cons_firewall:e&#45;&gt;int_stack:w</title>
<path fill="none" stroke="#000000" d="M137.8773,-340.1576C152.7872,-340.1576 158.8735,-340.1576 170.061,-340.1576"/>
<polygon fill="#000000" stroke="#000000" points="170.3928,-343.6577 180.3927,-340.1576 170.3927,-336.6577 170.3928,-343.6577"/>
</g>
<!-- xxx -->
<!-- cons_firewall&#45;&gt;xxx -->
<!-- int_user -->
<g id="node2" class="node">
<title>int_user</title>
<polygon fill="#7fff00" stroke="#7fff00" points="354.5779,-493.959 239.4221,-493.959 239.4221,-497.959 227.4221,-497.959 227.4221,-435.1562 354.5779,-435.1562 354.5779,-493.959"/>
<polyline fill="none" stroke="#7fff00" points="227.4221,-493.959 239.4221,-493.959 "/>
<text text-anchor="middle" x="291" y="-477.1576" font-family="Times,serif" font-size="14.00" fill="#000000">Internal user</text>
<text text-anchor="middle" x="291" y="-460.3576" font-family="Times,serif" font-size="14.00" fill="#000000"> e.g. CalDAV client</text>
<text text-anchor="middle" x="291" y="-443.5576" font-family="Times,serif" font-size="14.00" fill="#000000">10.38.2.80</text>
</g>
<!-- int_user&#45;&gt;int_stack -->
<g id="edge3" class="edge">
<title>int_user:se&#45;&gt;int_stack</title>
<path fill="none" stroke="#000000" d="M320,-435.5576C337.9236,-417.634 322.4338,-395.4859 300.9788,-377.0431"/>
<polygon fill="#000000" stroke="#000000" points="303.1476,-374.2955 293.1862,-370.6872 298.7233,-379.72 303.1476,-374.2955"/>
<text text-anchor="middle" x="280.5396" y="-422.9576" font-family="Times,serif" font-size="14.00" fill="#000000">unikernel task</text>
<text text-anchor="middle" x="280.5396" y="-406.1576" font-family="Times,serif" font-size="14.00" fill="#000000">using VPN</text>
</g>
<!-- ext_stack -->
<g id="node5" class="node">
<title>ext_stack</title>
<ellipse fill="#cd5b45" stroke="#cd5b45" cx="346" cy="-247.4469" rx="61.7425" ry="29.3416"/>
<ellipse fill="none" stroke="#cd5b45" cx="346" cy="-247.4469" rx="65.7501" ry="33.3315"/>
<text text-anchor="middle" x="346" y="-251.6469" font-family="Times,serif" font-size="14.00" fill="#000000">Ext. IP stack</text>
<text text-anchor="middle" x="346" y="-234.8469" font-family="Times,serif" font-size="14.00" fill="#000000">192.168.1.5</text>
</g>
<!-- int_stack&#45;&gt;ext_stack -->
<g id="edge2" class="edge">
<title>int_stack&#45;&gt;ext_stack</title>
<path fill="none" stroke="#6495ed" stroke-width="2" d="M284.3384,-304.0478C291.5788,-297.4016 299.1414,-290.4597 306.3897,-283.8063"/>
<polygon fill="#6495ed" stroke="#6495ed" stroke-width="2" points="309.1013,-286.0682 314.1015,-276.7275 304.3677,-280.9114 309.1013,-286.0682"/>
</g>
<!-- ext_user -->
<g id="node4" class="node">
<title>ext_user</title>
<polygon fill="#cd5b45" stroke="#cd5b45" points="479.705,-369.559 364.295,-369.559 364.295,-373.559 352.295,-373.559 352.295,-310.7562 479.705,-310.7562 479.705,-369.559"/>
<polyline fill="none" stroke="#cd5b45" points="352.295,-369.559 364.295,-369.559 "/>
<text text-anchor="middle" x="416" y="-352.7576" font-family="Times,serif" font-size="14.00" fill="#000000">External user</text>
<text text-anchor="middle" x="416" y="-335.9576" font-family="Times,serif" font-size="14.00" fill="#000000"> e.g. Ping (no VPN)</text>
<text text-anchor="middle" x="416" y="-319.1576" font-family="Times,serif" font-size="14.00" fill="#000000">192.168.1.5</text>
</g>
<!-- ext_user&#45;&gt;ext_stack -->
<g id="edge1" class="edge">
<title>ext_user&#45;&gt;ext_stack</title>
<path fill="none" stroke="#000000" stroke-width="1.5" stroke-dasharray="5,2" d="M393.8516,-310.8234C388.1438,-303.2638 381.9066,-295.0029 375.8767,-287.0167"/>
<polygon fill="#000000" stroke="#000000" stroke-width="1.5" points="378.5178,-284.7062 369.6988,-278.8345 372.9313,-288.9242 378.5178,-284.7062"/>
<text text-anchor="middle" x="433.312" y="-282.2234" font-family="Times,serif" font-size="14.00" fill="#000000">unikernel task</text>
<text text-anchor="middle" x="433.312" y="-265.4234" font-family="Times,serif" font-size="14.00" fill="#000000">no VPN</text>
</g>
<!-- provider_vpn -->
<g id="node8" class="node">
<title>provider_vpn</title>
<ellipse fill="#cd5b45" stroke="#cd5b45" cx="198" cy="-131.8156" rx="72.1304" ry="29.3416"/>
<ellipse fill="none" stroke="#cd5b45" cx="198" cy="-131.8156" rx="76.1339" ry="33.3315"/>
<text text-anchor="middle" x="198" y="-136.0156" font-family="Times,serif" font-size="14.00" fill="#000000">Upstream VPN</text>
<text text-anchor="middle" x="198" y="-119.2156" font-family="Times,serif" font-size="14.00" fill="#000000">1.2.3.4</text>
</g>
<!-- ext_stack&#45;&gt;provider_vpn -->
<g id="edge6" class="edge">
<title>ext_stack&#45;&gt;provider_vpn</title>
<path fill="none" stroke="#6495ed" stroke-width="2" d="M308.4719,-219.7206C299.1206,-212.7098 289.1525,-205.1491 280,-198.0313 267.5588,-188.3558 254.2068,-177.6953 241.9653,-167.8079"/>
<polygon fill="#6495ed" stroke="#6495ed" stroke-width="2" points="244.076,-165.0135 234.102,-161.4402 239.6707,-170.4535 244.076,-165.0135"/>
</g>
<!-- unproxied_target -->
<g id="node10" class="node">
<title>unproxied_target</title>
<polygon fill="#cd5b45" stroke="#cd5b45" points="452.7227,-152.4175 329.2773,-152.4175 329.2773,-156.4175 317.2773,-156.4175 317.2773,-111.2137 452.7227,-111.2137 452.7227,-152.4175"/>
<polyline fill="none" stroke="#cd5b45" points="317.2773,-152.4175 329.2773,-152.4175 "/>
<text text-anchor="middle" x="385" y="-136.0156" font-family="Times,serif" font-size="14.00" fill="#000000">Host reached directly</text>
<text text-anchor="middle" x="385" y="-119.2156" font-family="Times,serif" font-size="14.00" fill="#000000">192.168.1.1</text>
</g>
<!-- ext_stack&#45;&gt;unproxied_target -->
<g id="edge10" class="edge">
<title>ext_stack:se&#45;&gt;unproxied_target</title>
<path fill="none" stroke="#000000" stroke-width="1.5" stroke-dasharray="5,2" d="M376,-217.4469C390.0261,-203.4209 391.9297,-180.9282 390.5094,-162.5145"/>
<polygon fill="#000000" stroke="#000000" stroke-width="1.5" points="393.9809,-162.0633 389.3953,-152.5122 387.0239,-162.8383 393.9809,-162.0633"/>
</g>
<!-- padding -->
<!-- padding2 -->
<!-- proxied_target -->
<g id="node9" class="node">
<title>proxied_target</title>
<polygon fill="#7fff00" stroke="#7fff00" points="470.1729,-82.2019 309.8271,-82.2019 309.8271,-86.2019 297.8271,-86.2019 297.8271,-40.9981 470.1729,-40.9981 470.1729,-82.2019"/>
<polyline fill="none" stroke="#7fff00" points="297.8271,-82.2019 309.8271,-82.2019 "/>
<text text-anchor="middle" x="384" y="-65.8" font-family="Times,serif" font-size="14.00" fill="#000000">Host reached through proxy</text>
<text text-anchor="middle" x="384" y="-49" font-family="Times,serif" font-size="14.00" fill="#000000">6.6.6.6</text>
</g>
<!-- provider_vpn&#45;&gt;proxied_target -->
<g id="edge9" class="edge">
<title>provider_vpn&#45;&gt;proxied_target:w</title>
<path fill="none" stroke="#ff0000" stroke-width="3" stroke-dasharray="5,2" d="M224.3011,-99.9949C240.5706,-83.5938 263.0674,-66.2275 287.9664,-62.3825"/>
<polygon fill="#ff0000" stroke="#ff0000" stroke-width="3" points="288.3025,-65.8671 298,-61.6 287.7581,-58.8882 288.3025,-65.8671"/>
</g>
<!-- proxied_target&#45;&gt;unproxied_target -->
<!-- xxx&#45;&gt;int_stack -->
</g>
</svg>
