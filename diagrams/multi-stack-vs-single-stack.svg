<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: G Pages: 1 -->
<svg width="631pt" height="664pt"
 viewBox="0.00 0.00 631.00 664.20" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 660.2)">
<title>G</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-660.2 627,-660.2 627,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_cons</title>
<polygon fill="#66cd00" stroke="#458b00" stroke-width=".8" points="187,-530.6 187,-648.2 325,-648.2 325,-530.6 187,-530.6"/>
<text text-anchor="middle" x="256" y="-629.8" font-family="Times,serif" font-size="16.00" fill="#000000">Consumer</text>
<text text-anchor="middle" x="256" y="-610.6" font-family="Times,serif" font-size="16.00" fill="#000000">e.g. PongOS</text>
<text text-anchor="middle" x="256" y="-591.4" font-family="Times,serif" font-size="16.00" fill="#000000">or mirage&#45;firewall</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_two</title>
<path fill="#d3d3d3" stroke="#c0c0c0" stroke-width="1.5" d="M20,-261.4C20,-261.4 313,-261.4 313,-261.4 319,-261.4 325,-267.4 325,-273.4 325,-273.4 325,-501.6 325,-501.6 325,-507.6 319,-513.6 313,-513.6 313,-513.6 20,-513.6 20,-513.6 14,-513.6 8,-507.6 8,-501.6 8,-501.6 8,-273.4 8,-273.4 8,-267.4 14,-261.4 20,-261.4"/>
<text text-anchor="middle" x="76.4224" y="-495.2" font-family="Times,serif" font-size="16.00" fill="#000000">VPN unikernel</text>
<text text-anchor="middle" x="76.4224" y="-476" font-family="Times,serif" font-size="16.00" fill="#000000">Two stacks variant</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_one</title>
<path fill="#d3d3d3" stroke="#c0c0c0" stroke-width="1.5" d="M345,-330.4C345,-330.4 603,-330.4 603,-330.4 609,-330.4 615,-336.4 615,-342.4 615,-342.4 615,-619.8 615,-619.8 615,-625.8 609,-631.8 603,-631.8 603,-631.8 345,-631.8 345,-631.8 339,-631.8 333,-625.8 333,-619.8 333,-619.8 333,-342.4 333,-342.4 333,-336.4 339,-330.4 345,-330.4"/>
<text text-anchor="middle" x="396.9752" y="-613.4" font-family="Times,serif" font-size="16.00" fill="#000000">VPN unikernel</text>
<text text-anchor="middle" x="396.9752" y="-594.2" font-family="Times,serif" font-size="16.00" fill="#000000">One stack variant</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_up</title>
<path fill="#d3d3d3" stroke="#c0c0c0" stroke-width="1.5" d="M235,-157.2C235,-157.2 375,-157.2 375,-157.2 381,-157.2 387,-163.2 387,-169.2 387,-169.2 387,-232.4 387,-232.4 387,-238.4 381,-244.4 375,-244.4 375,-244.4 235,-244.4 235,-244.4 229,-244.4 223,-238.4 223,-232.4 223,-232.4 223,-169.2 223,-169.2 223,-163.2 229,-157.2 235,-157.2"/>
<text text-anchor="middle" x="276.0984" y="-226" font-family="Times,serif" font-size="16.00" fill="#000000">VPN provider</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_inet</title>
<polygon fill="none" stroke="#d3d3d3" stroke-width="1.5" stroke-dasharray="5,2" points="211,-8 211,-140.2 399,-140.2 399,-8 211,-8"/>
<text text-anchor="middle" x="257.8736" y="-16.8" font-family="Times,serif" font-size="16.00" fill="#000000">The internet</text>
</g>
<!-- cons_firewall -->
<g id="node1" class="node">
<title>cons_firewall</title>
<polygon fill="#7fff00" stroke="#7fff00" points="316.7548,-574.6 207.2452,-574.6 207.2452,-578.6 195.2452,-578.6 195.2452,-538.6 316.7548,-538.6 316.7548,-574.6"/>
<polyline fill="none" stroke="#7fff00" points="195.2452,-574.6 207.2452,-574.6 "/>
<text text-anchor="middle" x="256" y="-552.4" font-family="Times,serif" font-size="14.00" fill="#000000">Consumer IP stack</text>
</g>
<!-- uk_ip_down -->
<g id="node3" class="node">
<title>uk_ip_down</title>
<ellipse fill="#6495ed" stroke="#6495ed" cx="110" cy="-437.2" rx="57.3654" ry="18"/>
<ellipse fill="none" stroke="#6495ed" cx="110" cy="-437.2" rx="61.3609" ry="22"/>
<text text-anchor="middle" x="110" y="-433" font-family="Times,serif" font-size="14.00" fill="#000000">Int. IP stack</text>
</g>
<!-- cons_firewall&#45;&gt;uk_ip_down -->
<g id="edge12" class="edge">
<title>cons_firewall:w&#45;&gt;uk_ip_down</title>
<path fill="none" stroke="#000000" d="M195,-556.6C152.0396,-556.6 128.7738,-504.6669 117.9108,-469.3013"/>
<polygon fill="#000000" stroke="#000000" points="121.1832,-468.0171 115.0494,-459.3784 114.4573,-469.9567 121.1832,-468.0171"/>
</g>
<!-- ouk_ip -->
<g id="node10" class="node">
<title>ouk_ip</title>
<ellipse fill="#cd5b45" stroke="#cd5b45" cx="419" cy="-437.2" rx="71.2001" ry="18"/>
<ellipse fill="none" stroke="#cd5b45" cx="419" cy="-437.2" rx="75.2055" ry="22"/>
<text text-anchor="middle" x="419" y="-433" font-family="Times,serif" font-size="14.00" fill="#000000">Shared IP stack</text>
</g>
<!-- cons_firewall&#45;&gt;ouk_ip -->
<g id="edge10" class="edge">
<title>cons_firewall:se&#45;&gt;ouk_ip</title>
<path fill="none" stroke="#000000" d="M274,-538.6C283.9867,-519.6133 297.3252,-527.982 320,-513.6 342.2134,-499.5107 364.7748,-480.3458 382.8861,-464.7358"/>
<polygon fill="#000000" stroke="#000000" points="385.5897,-467.026 390.8771,-457.8448 381.0183,-461.7248 385.5897,-467.026"/>
</g>
<!-- cons_firewall&#45;&gt;ouk_ip -->
<!-- uk_local -->
<g id="node2" class="node">
<title>uk_local</title>
<polygon fill="#7fff00" stroke="#7fff00" points="316.5779,-457.8019 201.4221,-457.8019 201.4221,-461.8019 189.4221,-461.8019 189.4221,-416.5981 316.5779,-416.5981 316.5779,-457.8019"/>
<polyline fill="none" stroke="#7fff00" points="189.4221,-457.8019 201.4221,-457.8019 "/>
<text text-anchor="middle" x="253" y="-441.4" font-family="Times,serif" font-size="14.00" fill="#000000">Internal user</text>
<text text-anchor="middle" x="253" y="-424.6" font-family="Times,serif" font-size="14.00" fill="#000000"> e.g. CalDAV client</text>
</g>
<!-- uk_vpn -->
<g id="node5" class="node">
<title>uk_vpn</title>
<ellipse fill="#6495ed" stroke="#6495ed" cx="239" cy="-360.4" rx="73.5349" ry="18"/>
<ellipse fill="none" stroke="#6495ed" cx="239" cy="-360.4" rx="77.5358" ry="22"/>
<text text-anchor="middle" x="239" y="-356.2" font-family="Times,serif" font-size="14.00" fill="#000000">OpenVPN stack</text>
</g>
<!-- uk_local&#45;&gt;uk_vpn -->
<g id="edge4" class="edge">
<title>uk_local:sw&#45;&gt;uk_vpn</title>
<path fill="none" stroke="#000000" d="M232,-416.2C225.6798,-409.8798 224.775,-400.9441 226.2208,-392.0717"/>
<polygon fill="#000000" stroke="#000000" points="229.6527,-392.7752 228.6884,-382.2243 222.8626,-391.0736 229.6527,-392.7752"/>
<text text-anchor="middle" x="271.4604" y="-403.6" font-family="Times,serif" font-size="14.00" fill="#000000">unikernel task</text>
<text text-anchor="middle" x="271.4604" y="-386.8" font-family="Times,serif" font-size="14.00" fill="#000000">using VPN</text>
</g>
<!-- uk_ip_down&#45;&gt;uk_vpn -->
<g id="edge3" class="edge">
<title>uk_ip_down:se&#45;&gt;uk_vpn</title>
<path fill="none" stroke="#000000" d="M131,-416.2C145.2331,-401.9669 163.8513,-390.5941 181.6116,-381.9259"/>
<polygon fill="#000000" stroke="#000000" points="183.213,-385.0409 190.7931,-377.6387 180.2514,-378.6983 183.213,-385.0409"/>
</g>
<!-- uk_traceroute -->
<g id="node4" class="node">
<title>uk_traceroute</title>
<polygon fill="#cd5b45" stroke="#cd5b45" points="143.705,-381.0019 28.295,-381.0019 28.295,-385.0019 16.295,-385.0019 16.295,-339.7981 143.705,-339.7981 143.705,-381.0019"/>
<polyline fill="none" stroke="#cd5b45" points="16.295,-381.0019 28.295,-381.0019 "/>
<text text-anchor="middle" x="80" y="-364.6" font-family="Times,serif" font-size="14.00" fill="#000000">External user</text>
<text text-anchor="middle" x="80" y="-347.8" font-family="Times,serif" font-size="14.00" fill="#000000"> e.g. Ping (no VPN)</text>
</g>
<!-- uk_ip_up -->
<g id="node6" class="node">
<title>uk_ip_up</title>
<ellipse fill="#cd5b45" stroke="#cd5b45" cx="217" cy="-291.4" rx="60.2231" ry="18"/>
<ellipse fill="none" stroke="#cd5b45" cx="217" cy="-291.4" rx="64.2303" ry="22"/>
<text text-anchor="middle" x="217" y="-287.2" font-family="Times,serif" font-size="14.00" fill="#000000">Ext. IP stack</text>
</g>
<!-- uk_traceroute&#45;&gt;uk_ip_up -->
<g id="edge1" class="edge">
<title>uk_traceroute&#45;&gt;uk_ip_up</title>
<path fill="none" stroke="#000000" stroke-width="1.5" stroke-dasharray="5,2" d="M121.1045,-339.6977C136.9171,-331.7337 155.0616,-322.5952 171.2826,-314.4255"/>
<polygon fill="#000000" stroke="#000000" stroke-width="1.5" points="173.222,-317.3677 180.5788,-309.7435 170.0732,-311.1158 173.222,-317.3677"/>
<text text-anchor="middle" x="81.6441" y="-311.0977" font-family="Times,serif" font-size="14.00" fill="#000000">unikernel task</text>
<text text-anchor="middle" x="81.6441" y="-294.2977" font-family="Times,serif" font-size="14.00" fill="#000000">no VPN</text>
</g>
<!-- uk_vpn&#45;&gt;uk_ip_up -->
<g id="edge2" class="edge">
<title>uk_vpn&#45;&gt;uk_ip_up</title>
<path fill="none" stroke="#6495ed" stroke-width="2" d="M231.918,-338.1882C230.3871,-333.3867 228.7397,-328.2201 227.1181,-323.1341"/>
<polygon fill="#6495ed" stroke="#6495ed" stroke-width="2" points="230.4412,-322.0344 224.0688,-313.5702 223.772,-324.1609 230.4412,-322.0344"/>
</g>
<!-- up_vpn -->
<g id="node11" class="node">
<title>up_vpn</title>
<ellipse fill="#cd5b45" stroke="#cd5b45" cx="305" cy="-187.2" rx="70.1136" ry="18"/>
<ellipse fill="none" stroke="#cd5b45" cx="305" cy="-187.2" rx="74.1029" ry="22"/>
<text text-anchor="middle" x="305" y="-183" font-family="Times,serif" font-size="14.00" fill="#000000">Upstream VPN</text>
</g>
<!-- uk_ip_up&#45;&gt;up_vpn -->
<g id="edge8" class="edge">
<title>uk_ip_up&#45;&gt;up_vpn:w</title>
<path fill="none" stroke="#6495ed" stroke-width="2" d="M211.0806,-269.3019C204.9084,-242.2993 198.8044,-198.9864 220.0361,-189.2058"/>
<polygon fill="#6495ed" stroke="#6495ed" stroke-width="2" points="220.8874,-192.6047 230,-187.2 219.5059,-185.7423 220.8874,-192.6047"/>
</g>
<!-- unproxied_target -->
<g id="node13" class="node">
<title>unproxied_target</title>
<polygon fill="#cd5b45" stroke="#cd5b45" points="372.7227,-79.2 249.2773,-79.2 249.2773,-83.2 237.2773,-83.2 237.2773,-43.2 372.7227,-43.2 372.7227,-79.2"/>
<polyline fill="none" stroke="#cd5b45" points="237.2773,-79.2 249.2773,-79.2 "/>
<text text-anchor="middle" x="305" y="-57" font-family="Times,serif" font-size="14.00" fill="#000000">Host reached directly</text>
</g>
<!-- uk_ip_up&#45;&gt;unproxied_target -->
<g id="edge16" class="edge">
<title>uk_ip_up:sw&#45;&gt;unproxied_target:w</title>
<path fill="none" stroke="#000000" stroke-width="1.5" stroke-dasharray="5,2" d="M196,-270.4C131.4902,-205.8902 141.3806,-71.6506 226.7887,-61.7764"/>
<polygon fill="#000000" stroke="#000000" stroke-width="1.5" points="227.2132,-65.2581 237,-61.2 226.8186,-58.2692 227.2132,-65.2581"/>
</g>
<!-- ouk_local -->
<g id="node7" class="node">
<title>ouk_local</title>
<polygon fill="#7fff00" stroke="#7fff00" points="607.0772,-577.2019 494.9228,-577.2019 494.9228,-581.2019 482.9228,-581.2019 482.9228,-535.9981 607.0772,-535.9981 607.0772,-577.2019"/>
<polyline fill="none" stroke="#7fff00" points="482.9228,-577.2019 494.9228,-577.2019 "/>
<text text-anchor="middle" x="545" y="-560.8" font-family="Times,serif" font-size="14.00" fill="#000000">Internal user</text>
<text text-anchor="middle" x="545" y="-544" font-family="Times,serif" font-size="14.00" fill="#000000">e.g. CalDAV client</text>
</g>
<!-- ouk_local&#45;&gt;ouk_ip -->
<g id="edge6" class="edge">
<title>ouk_local:se&#45;&gt;ouk_ip:e</title>
<path fill="none" stroke="#000000" d="M566,-535.6C601.9235,-499.6765 554.8375,-444.6252 504.1599,-437.8841"/>
<polygon fill="#000000" stroke="#000000" points="504.2126,-434.3798 494,-437.2 503.7422,-441.364 504.2126,-434.3798"/>
<text text-anchor="middle" x="526.5396" y="-507" font-family="Times,serif" font-size="14.00" fill="#000000">unikernel task</text>
<text text-anchor="middle" x="526.5396" y="-490.2" font-family="Times,serif" font-size="14.00" fill="#000000">using VPN</text>
</g>
<!-- ouk_traceroute -->
<g id="node8" class="node">
<title>ouk_traceroute</title>
<polygon fill="#cd5b45" stroke="#cd5b45" points="464.7052,-577.2019 353.2948,-577.2019 353.2948,-581.2019 341.2948,-581.2019 341.2948,-535.9981 464.7052,-535.9981 464.7052,-577.2019"/>
<polyline fill="none" stroke="#cd5b45" points="341.2948,-577.2019 353.2948,-577.2019 "/>
<text text-anchor="middle" x="403" y="-560.8" font-family="Times,serif" font-size="14.00" fill="#000000">External user</text>
<text text-anchor="middle" x="403" y="-544" font-family="Times,serif" font-size="14.00" fill="#000000">e.g. Ping (no VPN)</text>
</g>
<!-- ouk_traceroute&#45;&gt;ouk_ip -->
<g id="edge7" class="edge">
<title>ouk_traceroute:se&#45;&gt;ouk_ip</title>
<path fill="none" stroke="#000000" stroke-width="1.5" stroke-dasharray="5,2" d="M424,-535.6C440.9155,-518.6845 437.8571,-490.8844 431.5998,-469.1403"/>
<polygon fill="#000000" stroke="#000000" stroke-width="1.5" points="434.8408,-467.7849 428.4529,-459.3324 428.1755,-469.9236 434.8408,-467.7849"/>
<text text-anchor="middle" x="384.5396" y="-507" font-family="Times,serif" font-size="14.00" fill="#000000">unikernel task</text>
<text text-anchor="middle" x="384.5396" y="-490.2" font-family="Times,serif" font-size="14.00" fill="#000000">no VPN</text>
</g>
<!-- ouk_vpn -->
<g id="node9" class="node">
<title>ouk_vpn</title>
<ellipse fill="#6495ed" stroke="#6495ed" cx="525" cy="-360.4" rx="73.5349" ry="18"/>
<ellipse fill="none" stroke="#6495ed" cx="525" cy="-360.4" rx="77.5358" ry="22"/>
<text text-anchor="middle" x="525" y="-356.2" font-family="Times,serif" font-size="14.00" fill="#000000">OpenVPN stack</text>
</g>
<!-- ouk_ip&#45;&gt;ouk_vpn -->
<g id="edge5" class="edge">
<title>ouk_ip&#45;&gt;ouk_vpn</title>
<path fill="none" stroke="#6495ed" stroke-width="2" d="M455.5205,-410.7399C466.1045,-403.0715 477.6621,-394.6976 488.2595,-387.0196"/>
<polygon fill="#6495ed" stroke="#6495ed" stroke-width="2" points="453.4505,-407.9175 447.4061,-416.619 457.5575,-413.5861 453.4505,-407.9175"/>
<polygon fill="#6495ed" stroke="#6495ed" stroke-width="2" points="490.4711,-389.7393 496.5155,-381.0378 486.3641,-384.0707 490.4711,-389.7393"/>
<text text-anchor="middle" x="541.0747" y="-394.6" font-family="Times,serif" font-size="14.00" fill="#000000">Hook in routing table</text>
</g>
<!-- ouk_ip&#45;&gt;up_vpn -->
<g id="edge14" class="edge">
<title>ouk_ip&#45;&gt;up_vpn:ne</title>
<path fill="none" stroke="#6495ed" stroke-width="2" d="M408.6048,-415.3121C407.366,-412.5911 406.1383,-409.8387 405,-407.2 368.7063,-323.0669 391.447,-278.8374 333.1137,-215.5995"/>
<polygon fill="#6495ed" stroke="#6495ed" stroke-width="2" points="335.4536,-212.9833 326,-208.2 330.4073,-217.8346 335.4536,-212.9833"/>
</g>
<!-- ouk_ip&#45;&gt;unproxied_target -->
<g id="edge15" class="edge">
<title>ouk_ip&#45;&gt;unproxied_target:e</title>
<path fill="none" stroke="#000000" stroke-width="1.5" stroke-dasharray="5,2" d="M419,-415.0188C419,-399.6797 419,-378.8 419,-360.4 419,-360.4 419,-360.4 419,-114.2 419,-86.5429 407.3556,-66.2616 382.9715,-62.0216"/>
<polygon fill="#000000" stroke="#000000" stroke-width="1.5" points="383.2537,-58.533 373,-61.2 382.6788,-65.5094 383.2537,-58.533"/>
</g>
<!-- proxied_target -->
<g id="node12" class="node">
<title>proxied_target</title>
<polygon fill="#7fff00" stroke="#7fff00" points="391.1729,-132.2 230.8271,-132.2 230.8271,-136.2 218.8271,-136.2 218.8271,-96.2 391.1729,-96.2 391.1729,-132.2"/>
<polyline fill="none" stroke="#7fff00" points="218.8271,-132.2 230.8271,-132.2 "/>
<text text-anchor="middle" x="305" y="-110" font-family="Times,serif" font-size="14.00" fill="#000000">Host reached through proxy</text>
</g>
<!-- up_vpn&#45;&gt;proxied_target -->
<g id="edge13" class="edge">
<title>up_vpn&#45;&gt;proxied_target</title>
<path fill="none" stroke="#ff0000" stroke-width="3" stroke-dasharray="5,2" d="M305,-164.9009C305,-157.8332 305,-149.9238 305,-142.493"/>
<polygon fill="#ff0000" stroke="#ff0000" stroke-width="3" points="308.5001,-142.4444 305,-132.4444 301.5001,-142.4445 308.5001,-142.4444"/>
</g>
<!-- proxied_target&#45;&gt;unproxied_target -->
</g>
</svg>
